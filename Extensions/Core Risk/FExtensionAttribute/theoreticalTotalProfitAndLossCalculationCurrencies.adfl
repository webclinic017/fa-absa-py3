[Core Risk]FInstrumentAndTrades:theoreticalTotalProfitAndLossCalculationCurrencies = flattenAndRemoveDuplicates([select(forwardFxRateConversion, 
  true->flattenAndRemoveDuplicates([theoreticalValueCurrenciesFromDiscountingUnits, forwardFXConversionCurrency]), 
  false->theoreticalValueCurrenciesFromDiscountingUnits), profitAndLossValuesCurrencies]);