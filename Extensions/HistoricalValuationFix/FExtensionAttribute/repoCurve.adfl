[HistoricalValuationFix]FInstrument:repoCurve = select(useExplicitRepoCurve, 
  true->mappedRepoLink :* "repoCurve" [valuationDate], 
  false->repoUnit:moneyMarketCurve);
[HistoricalValuationFix]FYieldCurveHierarchy:repoCurve = delta(repoYieldCurveComponent :* "repoIrCurveInformation" [component = underlyingComponent, valuationDate], repoCurveShift);