[Core Pricing]FCombination:markToMarketValuesUndiscounted = select("Accounting Date" == instrumentReportDate, 
  true->markToMarketInstrumentPositionValues * timeDistributionFactor + interestFromTodayToAccountingDate, 
  false->markToMarketInstrumentPositionValues * timeDistributionFactor) + positionValues;
[Core Pricing]FInstrument:markToMarketValuesUndiscounted = select(mtmFromFeed, 
  true->select(useFallbackToTheoreticalValues, 
    true->select(isFinite(marketPrice), 
      true->collapse(marketValuesUndiscounted), 
      false->collapse(theoreticalOrFixedMarkToMarketValuesUndiscounted)), 
    false->collapse(marketValuesUndiscounted)), 
  false->collapse(theoreticalOrFixedMarkToMarketValuesUndiscounted));