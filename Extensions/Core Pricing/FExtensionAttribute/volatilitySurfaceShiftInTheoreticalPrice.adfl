[Core Pricing]FInstrument:volatilitySurfaceShiftInTheoreticalPrice = select(optionVolatilityStructureInTheoreticalPrice, 
  nil->nil, 
  default->snoop01(theoreticalPrice, "surfaceSimulationVolatilityShift", optionVolatilityStructureInTheoreticalPrice.VolatilityStructure));
[Core Pricing]FInstrumentAndTrades:volatilitySurfaceShiftInTheoreticalPrice = openInstrumentOrInstrument:volatilitySurfaceShiftInTheoreticalPrice [theoreticalPrice, priceSource, isSplitAllGrouped];
[Core Pricing]FMultiInstrumentAndTrades:volatilitySurfaceShiftInTheoreticalPrice = nil;