[Core Pricing]FCurrency:historicalImmediateOrSpotFxRate = fxRateInstrument :* "historicalImmediateOrSpotFxRate" [fxHistoricalDate, fxHistoricalForwardDate];
[Core Pricing]FFxRate:historicalImmediateOrSpotFxRate = select(foreignEqualsDomestic, 
  true->1.0, 
  false->select(immediateFxRates, 
    true->fxRateWithHistoricalParameters, 
    false->stripDateTimePart(historicalSimplisticFXSpotRate)));