[Core Pricing]FDerivative:underlyingForwardValueCurrency = select(isFXDerivative, 
  true->underlying:underlyingForwardValueCurrency, 
  false->calculationCurrency);
[Core Pricing]FFxRate:underlyingForwardValueCurrency = select(isReciprocal, 
  true->foreignCurrency, 
  false->currency);
[Core Pricing]FInstrument:underlyingForwardValueCurrency = currency;