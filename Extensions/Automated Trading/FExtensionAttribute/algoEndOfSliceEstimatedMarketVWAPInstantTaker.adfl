[Automated Trading]ExecutionAlgo:algoEndOfSliceEstimatedMarketVWAPInstantTaker = switch(marketTotalQtyDuringExecution, 
  0->double(matchPrice), 
  default->(double(periodVWAP) * marketTotalQtyDuringExecution + double(matchPrice) * algoRemainingMarketQtyInSlice) / (marketTotalQtyDuringExecution + algoRemainingMarketQtyInSlice));