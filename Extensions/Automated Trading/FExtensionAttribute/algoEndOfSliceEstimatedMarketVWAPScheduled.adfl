[Automated Trading]ExecutionAlgo:algoEndOfSliceEstimatedMarketVWAPScheduled = switch(marketTotalQtyDuringExecution, 
  0->double(homeMarketSpreadAveragePrice), 
  default->(double(periodVWAP) * marketTotalQtyDuringExecution + double(homeMarketSpreadAveragePrice) * algoRemainingMarketQtyInSlice) / (marketTotalQtyDuringExecution + algoRemainingMarketQtyInSlice));