[Historical Valuation]FETF:underlying = historicalEntity(actualUnderlying, liveOrSnapshotPositionDateTime, useValidFrom);
[Historical Valuation]FFuture:underlying = historicalEntity(select(isFutureOnNotional, 
  true->ctd, 
  false->object.ValuationUnderlying), liveOrSnapshotPositionDateTime, useValidFrom);
[Historical Valuation]FInstrument:underlying = historicalEntity(object.ValuationUnderlying, liveOrSnapshotPositionDateTime, useValidFrom);