[Fixed Income Pricing and Risk]FInstrument:marketYieldToMaturity = select(ytmCalculationValid, 
  true->shunt(implyValid, 
    false->nil, 
    true->select(isYtmSimpleCalculation, 
      true->object.YTMSimpleCalculation(marketPrice, valuationDate), 
      default->imply(yieldInTheoreticalPrice, theoreticalInstrumentSpotPriceFromYieldForYTMSpread, marketPrice, ytmAccuracy, -0.5, 1.0, implyMaxIterations))), 
  false->nil);
[Fixed Income Pricing and Risk]FInstrumentAndTrades:marketYieldToMaturity = instrument :* "marketYieldToMaturity" [marketPrice];
[Fixed Income Pricing and Risk]FMultiInstrumentAndTrades:marketYieldToMaturity = nil;