[Equity Pricing and Risk]FCombination:theoreticalSpotValueFromComponentMarketOrTheoreticalValueFixFx = select(sumOf(instrumentMaps :* "count(instrument:instrumentCurrencies)") > numberOfLegs, 
  true->convertToCurrencyValidateDates(theoreticalInstrumentValueAtSpot, instrumentCurrencies :* "fxForwardRate" [fxForwardDate = instrumentSpotDate, fxToCurrency := currency], currencySymbol), 
  false->convertToCurrencyValidateDates(theoreticalInstrumentValueAtSpot, filterDuplicateFactors(instrumentMaps :* "fixFxLegToInstrument"), currencySymbol));