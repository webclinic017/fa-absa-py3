[Equity Pricing and Risk]FLeg:theoreticalLegComponentValueSlimVirtualCashFlows = switch(count(projectedVirtualCashFlows) > 0, 
  false->collapse(theoreticalLegComponentValueSlim), 
  true->sumOf(addArrays(virtualCashFlowsDiscounted, theoreticalLegComponentValueSlim)));