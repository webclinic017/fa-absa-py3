[_brokerage_risk_exts]FCurrency:initialMarginSimpleModel = currencyZero;
[_brokerage_risk_exts]FDeposit:initialMarginSimpleModel = currencyZero;
[_brokerage_risk_exts]FInstrument:initialMarginSimpleModel = switch(isZeroMargin, 
  true->currencyZero, 
  default->switch(initialMarginCondition <> nil, 
    true->switch(initialMarginCurve.CurveType, 
      "Percentage"->initialMarginCurve.MinValue / 100.0 * abs(object:exposureValue [portfolio, priceSource, valuesOnSpotOverride, positionObject, tradeCategoryInclusionMaskDefault]), 
      "Per unit"->convertToCurrency(denominatedvalue(initialMarginCurve.MinValue, initialMarginCurve.Currency, , ) * abs(marginPosition), initialMarginFxRates, displayCurrencySymbol), 
      default->nil), 
    default->abs(object:exposureValue [portfolio, priceSource, valuesOnSpotOverride, positionObject, tradeCategoryInclusionMaskDefault])));