[Credit Pricing and Risk]FInstrument:impliedTheoreticalCorrelation = select(valuationModelCanCalibrateCorrelation, 
  false->nil, 
  default->imply(snoop(theoreticalPriceBySingleCorrelation, "instrumentCorrelation"), theoreticalPriceBySingleCorrelation, theoreticalPrice, 0, 0, 0.9999, 100));
[Credit Pricing and Risk]FInstrumentAndTrades:impliedTheoreticalCorrelation = instrument :* "impliedTheoreticalCorrelation" [theoreticalPrice];
[Credit Pricing and Risk]FMultiInstrumentAndTrades:impliedTheoreticalCorrelation = nil;