[Treasury Pricing and Risk]FInstrument:priceDeltaTradeAdjustment = (priceDeltaTradeAdjustmentCurrency:fxDiscountCurve).DiscountValuesStartFromBreakDate(priceDeltaTradeAdjustmentUndiscounted, underlyingFXSpotDate, valuationDate);
[Treasury Pricing and Risk]FInstrumentAndTrades:priceDeltaTradeAdjustment = shunt(priceGreekRiskFactorNodeCount, 
  0->priceDeltaTradeAdjustmentValue, 
  1->shunt(priceDeltaFXRateRiskFactor == nil, 
    true->0, 
    false->priceDeltaTradeAdjustmentValue), 
  default->0);