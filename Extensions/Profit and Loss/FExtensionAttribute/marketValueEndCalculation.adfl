[Profit and Loss]FInstrumentAndTrades:marketValueEndCalculation = marketValue;
[Profit and Loss]FLegAndTrades:marketValueEndCalculation = notANumberIsZero(shift(markToMarketValue, snoop(markToMarketValue, "valuationBaseDateTimeInput"), [profitAndLossEndDateTime]));