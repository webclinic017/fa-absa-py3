[Profit and Loss]FInstrumentAndTrades:theoreticalValueDiscountingUnitsAtEndDate = shunt[profitAndLossEndDate, valuesOnSpotOverride](profitAndLossEndDateIsHistorical, 
  true->object:theoreticalValueDiscountingUnits [valuesOnSpotOverride, openPositionsPerPortfolio := valuationPerPortfolio, valuationBaseDateTimeInput = profitAndLossEndDateTime], 
  false->object:theoreticalValueDiscountingUnits [valuesOnSpotOverride, openPositionsPerPortfolio := valuationPerPortfolio]);