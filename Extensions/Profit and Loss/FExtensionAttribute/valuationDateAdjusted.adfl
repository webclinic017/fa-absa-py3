[Profit and Loss]FCombInstrMapAndTrades:valuationDateAdjusted = instrument :* "valuationDateAdjusted" [valuationBaseDateTimeInput];
[Profit and Loss]FInstrument:valuationDateAdjusted = select(valuesOnSpot, 
  true->object.SpotDate(valuationDate), 
  false->valuationDate);
[Profit and Loss]FLegAndTrades:valuationDateAdjusted = instrument :* "valuationDateAdjusted" [valuationBaseDateTimeInput];
[Profit and Loss]FSingleInstrumentAndTrades:valuationDateAdjusted = instrument :* "valuationDateAdjusted" [valuationBaseDateTimeInput];
[Profit and Loss]FTradeRow:valuationDateAdjusted = instrument :* "valuationDateAdjusted" [valuationBaseDateTimeInput];