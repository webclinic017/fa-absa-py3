[Default]FInstrument:variationSwapHistoricalVarianceInTheoPriceCalc = nil;
[Default]FVolatilityFuture:variationSwapHistoricalVarianceInTheoPriceCalc = switch(theoreticalPriceIsExpired, 
  true->nil, 
  default->switch((variationSwapNHistoricalPriceFixings < 1), 
    true->0.0, 
    default->switch(theoreticalModelCallUsesHistoricalOnly, 
      true->variationSwapCappedHistoricalVariance, 
      default->snoop01(theoreticalPrice, ["sumSquaredReturns"]) * variationSwapTradingDaysPerYear * 10000 / variationSwapNHistoricalPriceFixings)));