[Default]FCashFlowInstrument:combinationDiscountOrRiskFreeCurvesForProfitAndLossMoveValue = select(isCredit, 
  true->riskFreeDiscountCurvesForProfitAndLoss, 
  false->discountCurvesForProfitAndLoss);
[Default]FCombInstrMap:combinationDiscountOrRiskFreeCurvesForProfitAndLossMoveValue = instrument:combinationDiscountOrRiskFreeCurvesForProfitAndLossMoveValue [valuationBaseDateTimeInput];
[Default]FCombination:combinationDiscountOrRiskFreeCurvesForProfitAndLossMoveValue = (instrumentMaps :* "combinationDiscountOrRiskFreeCurvesForProfitAndLossMoveValue" [valuationBaseDateTimeInput]).Flatten;
[Default]FInstrument:combinationDiscountOrRiskFreeCurvesForProfitAndLossMoveValue = nil;