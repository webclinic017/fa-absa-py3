[Default]FInstrumentAndTrades:vannaVolgaAdjustment = snoop01(theoreticalPrice, "vannaVolgaAdjustment");
[Default]FOption:vannaVolgaAdjustment = select(object.VannaVolgaFactorType, 
  "Vanilla Replication"->(1 - knockOutFactor) * vannaVolgaVanillaAdjustment + knockOutFactor * (vannaVolgaExoticVegaAdjustment + vannaVolgaExoticVannaAdjustment + vannaVolgaExoticVolgaAdjustment), 
  default->vannaVolgaFactor * (vannaVolgaExoticVegaAdjustment + vannaVolgaExoticVannaAdjustment + vannaVolgaExoticVolgaAdjustment));