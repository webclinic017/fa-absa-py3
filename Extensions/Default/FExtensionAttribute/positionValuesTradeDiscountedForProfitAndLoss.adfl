[Default]FInstrument:positionValuesTradeDiscountedForProfitAndLoss = select(discountPositionValuesTrade, 
  true->object:discountAndConvertToBaseForProfitLoss [filterUnit, valuationBaseDateTimeInput, discountAndConvertToBaseDiscountingUnits, discountAndConvertToBaseValues = positionValuesTradeForProfitAndLoss, valuesOnSpotOverride], 
  false->positionValuesTradeForProfitAndLoss);
[Default]FInstrumentAndTrades:positionValuesTradeDiscountedForProfitAndLoss = openInstrument :* "collapse(positionValuesTradeDiscountedForProfitAndLoss)" [valuesOnSpotOverride, valuationBaseDateTimeInput, positionObject, plSpotGroupingReference, discountPositionValuesTrade];
[Default]FMultiInstrumentAndTrades:positionValuesTradeDiscountedForProfitAndLoss = sumOf(openInstruments :* "collapse(positionValuesTradeDiscountedForProfitAndLoss)" [valuesOnSpotOverride, valuationBaseDateTimeInput, positionObject, plSpotGroupingReference, discountPositionValuesTrade]);
[Default]FTradeRow:positionValuesTradeDiscountedForProfitAndLoss = shunt[valuesOnSpotOverride, valuationBaseDateTimeInput, discountPositionValuesTrade](isOpenPosition, 
  true->instrument :* "collapse(positionValuesTradeDiscountedForProfitAndLoss)" [valuesOnSpotOverride, valuationBaseDateTimeInput, singleTradePosition, includeAllTrades, discountPositionValuesTrade, positionObject, profitAndLossParameters], 
  false->spotHandlingZero);