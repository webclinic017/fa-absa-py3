[Default]FDerivative:underlyingForwardValueCurrency = select(isFXDerivative, 
  true->underlying:underlyingForwardValueCurrency, 
  false->calculationCurrency);
[Default]FFxRate:underlyingForwardValueCurrency = select(isReciprocal, 
  true->foreignCurrency, 
  false->currency);
[Default]FInstrument:underlyingForwardValueCurrency = currency;