[Default]FInstrument:markToMarketValuesUnNormalized = select(valuesOnSpot, 
  true->adjustForSpotHandling(markToMarketValues, true), 
  false->markToMarketValuesUndiscounted);
[Default]FInstrumentAndTrades:markToMarketValuesUnNormalized = openInstrument :* "collapse(markToMarketValuesUnNormalized)" [priceSource, isSplitAllGrouped, valuesOnSpotOverride, positionObject, useMarkToMarketPriceToday, useFallbackToTheoreticalValues, profitAndLossParameters, filterUnit, groupingSpotDiscountDate];
[Default]FLegAndTrades:markToMarketValuesUnNormalized = openInstrument :* "adjustForSpotHandling(theoreticalLegValuesMoved, valuesOnSpot)" [priceSource, isSplitAllGrouped, valuesOnSpotOverride, positionObject, tradesInPosition, legs, profitAndLossParameters, filterUnit, groupingSpotDiscountDate];
[Default]FMultiInstrumentAndTrades:markToMarketValuesUnNormalized = sumOf(openInstruments :* "collapse(markToMarketValuesUnNormalized)" [priceSource, isSplitAllGrouped, valuesOnSpotOverride, positionObject, useMarkToMarketPriceToday, useFallbackToTheoreticalValues, profitAndLossParameters, filterUnit, groupingSpotDiscountDate]);