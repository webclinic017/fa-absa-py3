[Default]FInstrument:upperBaseCorrelations = select(baseCorrelationMatrix, 
  nil->nil, 
  default->select(isMonteCarloCreditBasket, 
    true->flatCorrelationMatrix(upperBaseCorrelationCouple.At(1), count(creditIssuer)), 
    default->upperBaseCorrelationCouple.At(1)));