[Default]FCashFlowInstrument:impliedFloatFactor = select(implyValid, 
  true->select(isGenericSpreadQuoted, 
    false->select(numberOfFloatOrCapFloorLegs, 
      1->firstNonFixedLeg :* "impliedFloatFactor" [priceSource], 
      default->select(floatOrCapFloorPayLegOrNil, 
        default->floatOrCapFloorPayLegOrNil :* "impliedFloatFactor" [priceSource], 
        nil->nil)), 
    false->nil), 
  true->nil);
[Default]FFra:impliedFloatFactor = nil;
[Default]FInstrument:impliedFloatFactor = nil;
[Default]FInstrumentAndTrades:impliedFloatFactor = instrument :* "impliedFloatFactor" [priceSource];
[Default]FLeg:impliedFloatFactor = shunt[priceSource](isFloatOrCapFloorLeg and implyValid, 
  true->imply(shiftedFloatFactor, theoreticalPriceShiftFloatFactor, marketPrice, instrument:implyPrecision, instrument:impliedFloatFactorMinValue, instrument:impliedFloatFactorMaxValue, 100), 
  false->nil);
[Default]FLegAndTrades:impliedFloatFactor = select(instrument:isGenericSpreadQuoted, 
  false->leg :* "impliedFloatFactor" [priceSource], 
  true->nil);
[Default]FMultiInstrumentAndTrades:impliedFloatFactor = nil;