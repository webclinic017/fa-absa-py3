import acm

list = [77515579,
77515578,
77478421,
77478420,
77477352,
77477351,
77477235,
77477234,
77477034,
77477033,
77077854,
77077853,
76956382,
76956381,
76955807,
76955804,
76955586,
76955585,
76951809,
76951808,
76824570,
76824569,
76789956,
76789955,
76696213,
76696212,
76696183,
76696182,
76696180,
76696179,
76696168,
76696167,
76696157,
76696156,
76696141,
76696140,
75682752,
75682751,
75679958,
75679959,
75679566,
75679565,
75679295,
75679294,
75679243,
75679244,
75679168,
75679169,
75679130,
75679131,
75679048,
75679049,
75678716,
75678676,
75678677,
75107800,
75107801,
75107520,
75107519,
73820473,
73820472,
73456538,
73456537]

for trdnbr in list:
    trade = acm.FTrade[trdnbr].Clone()
    trade.Quantity(-1 * trade.Quantity())
    trade.Premium(-1 * trade.Premium())
    trade.TrxTrade(None)
    trade.MirrorTrade(None)
    trade.ContractTrdnbr(None)
    trade.ConnectedTrade(None)
    trade.ArchiveStatus(0)
    try:
        trade.Commit()
        print(trdnbr, ':', trade.Oid())
    except Exception, e:
        print('ERROR: %i: %s' %(trdnbr, str(e)))
