import acm
from at_ael_variables import AelVariableHandler

FOLDERS = acm.FStoredASQLQuery.Select('subType="FTrade"')

ael_variables = AelVariableHandler()

tradeList = [58630694,
58630693,
58630101,
58630098,
58555815,
58555814,
58555168,
58555167,
58555023,
58555022,
58554815,
58554814,
58554501,
58554500,
58554015,
58554014,
58553653,
58553652,
58552972,
58552971,
58500478,
58469440,
58464112,
58461958,
58459617,
58455063,
58454618,
58454291,
58453827,
58072936,
57293735,
57178006,
57178005,
57176483,
57176482,
57176428,
57176427,
57176347,
57176346,
57176198,
57176194,
57175993,
57175992,
57175877,
57175876,
57175551,
57175550,
56128598,
54991926,
54991925,
54991924,
54991923,
54991922,
54991921,
54991920,
54991919,
54991918,
54991917,
54991914,
54991913,
54991912,
54991911,
54991910,
54991909,
54991908,
54991907,
54991906,
54991905,
54991904,
54991903,
54991902,
54991901,
54991900,
54991899,
54991898,
54991897,
54991896,
54991895,
50811461,
50797848,
43387483,
42523571,
42517913,
42445962,
42445961,
42096621,
42096620,
42096619,
42096618,
42096617,
42096616,
42096601,
42096600,
42096599,
42096598,
42096550,
42096549,
42096433,
42096432,
41116860,
41116536,
41116109,
41115705,
39675914,
39675913,
39671942,
39671941,
38370890,
38370889,
38370794,
38370793,
38370610,
38370609,
38368965,
38368964,
38368707,
38368706,
38338429,
36970728,
35236939,
34271080,
34271079,
34271078,
34271077,
34271071,
34271070,
33607902,
33607901,
33009750,
33009749,
33009715,
33009714,
33009605,
33009604,
33009495,
33009494,
32367559,
32367506,
32367471,
32367376,
32367320,
32367241,
32367152,
32367031,
31561078,
31561076,
31560953,
31560952,
31560538,
31560537,
30780463,
30780462,
30780428,
30780427,
30780393,
30780392,
30780360,
30780359,
29995084,
29995083,
29995050,
29995049,
29553884,
29508328,
29053463,
29053462,
29051297,
29051296,
29051128,
29051127,
29050743,
29050742,
28480892,
28134777,
28134774,
28131215,
28131214,
28131135,
28131134,
28131083,
28131082,
28130612,
28130611,
28130202,
28130201,
28130031,
28130030,
28129989,
28129988,
28129832,
28129831,
28129677,
28129676,
28128265,
28128227,
28128182,
28128038,
28127710,
28127404,
28005113,
27769187,
27768525,
26270303,
26246809,
25992672,
25992671,
25992433,
25992432,
25992328,
25992327,
25525043,
25074872,
25074526,
25071478,
25070378,
24107461,
24107460,
24106856,
24106855,
24106795,
24106794,
24106716,
24106715,
24106670,
24106669,
23857541,
23740712,
23740711,
23740685,
23740684,
23615533,
22902430,
22443210,
22443073,
22438600,
22232049,
22123878,
22123877,
22123111,
22123110,
22123011,
22123010,
22091564,
22091563,
22089569,
21892088,
21892087,
21880638,
21880637,
21862678,
21862677,
21839891,
21839890,
21836641,
21836640,
21827041,
21827040,
21817461,
21817460,
21810174,
21810160,
21782801,
21782800,
21777681,
21777680,
21754762,
21754761,
21629570,
21628906,
21565377,
21565376,
21548138,
21548137,
21504021,
21504020,
21459426,
21459425,
21459164,
21459163,
21458556,
21458555,
21094263,
20951268,
20239806,
20239805,
20239534,
20239533,
20239440,
20239439,
19395345,
19301526,
19301525,
19301160,
19301159,
18398689,
18344245,
17962904,
17962903,
17773838,
17773837,
17678829,
17678776,
17678491,
17602828,
17602827,
17602652,
17602651,
17433767,
17433766,
17433427,
17433426,
17386527,
17327617,
17327616,
17327537,
17327508,
17200843,
17091203,
17090764,
17073702,
17073701,
17050957,
17050956,
17045362,
17045361,
17044742,
17044741,
16942090,
16942089,
16942078,
16942077,
16937792,
16937791,
16937295,
16937294,
16936817,
16936816,
16936705,
16936704,
16936025,
16936024,
16935961,
16935960,
16935310,
16935309,
16935267,
16935266,
16935065,
16935064,
16934923,
16934922,
16934493,
16934492,
16934478,
16934477,
16934064,
16934063,
16933791,
16933790,
16933342,
16933341,
16933100,
16933099,
16932780,
16932779,
16930948,
16930947,
16748815,
16748761,
16748055,
16577256,
16577255,
16438127,
16438126,
16438025,
16438024,
16377304,
16377303,
16375702,
16375701,
16374792,
16374791,
16374048,
16374047,
16372704,
16372703,
16371402,
16371401,
16371051,
16371050,
16370902,
16370901,
16368762,
16361980,
16361979,
16361720,
16361719,
16361533,
16361532,
16361297,
16361296,
16361264,
16361263,
16361194,
16361193,
16360821,
16360819,
16360775,
16360774,
16360610,
16360609,
16360577,
16360576,
16360536,
16360535,
16360487,
16360486,
16360276,
16360275,
16360236,
16360235,
16360228,
16360227,
16360125,
16360124,
16346351,
16346350,
16322429,
15911276,
15467814,
15463449,
15429805,
15385502,
15334880,
15101574,
15101573,
13882266,
13882246,
13882202,
13882136,
13882135,
13882124,
13882117,
13882104,
13882084,
13882078,
13882068,
13882049,
13881995,
13881922,
13881915,
13881876,
13881860,
13881788,
13881759,
13881667,
13881597,
13881579,
13881562,
13881535,
13880867,
13880845,
13879642,
13879628,
13879597,
13879588,
13879575,
13879560,
13879511,
13879502,
13879476,
13879454,
13879277,
13879269,
13879217,
13879196,
13879173,
13879117,
13879103,
13879066,
13879050,
13879042,
13879010,
13878950,
13878925,
13878913,
13878896,
13878877,
13878618,
13878600,
13878597,
13878595,
13878593,
13878588,
13878581,
13382921,
13145612,
13145599,
13136969,
13136939,
13136922,
13136769,
13136572,
13136477,
13136461,
13136428,
13136280,
13136260,
13136242,
13136177,
13135913,
12842855,
12842615,
12842550,
12842491,
12841988,
12838411,
12838388,
12838289,
12838090,
12838041,
12837901,
12837869,
12837855,
12837834,
12837261,
12837244,
12837197,
12836646,
12675628,
12675593,
12674298,
12669269,
12669059,
3439721,
13142363,
13142220,
2958849]

'''
ael_variables.add(
    'tradeNumbers',
    label = 'Trade Numbers',
    cls = 'string',
    collection = None,
    default = None,
    mandatory = True,
    multiple = False,
    alt = 'List of trades to update.'
    )
'''
ael_variables.add(
    'trade_status',   
    label = 'Trade Status',
    cls = 'string',
    collection = ['FO Confirmed', 'BO Confirmed'],
    default = 'BO Confirmed',
    mandatory = True,
    alt = 'Trade Status for update'
    )

ael_gui_parameters = {'windowCaption':'Update Trade Status'}

def ael_main(ael_dict):
    '''
    try:
        trade_set = ael_dict['tradeNumbers']
        acm.Log('Process will update %s trades' %len(trade_set))
    except Exception, e:
        acm.Log('Error with query folder: %s' %e)
        return
    '''
    new_status = ael_dict['trade_status']
    
    for t in tradeList:
        trade = acm.FTrade[t]
        try:
            trade.Status(new_status)
            trade.Commit()
            acm.Log('Trade %s updated to %s' %(trade.Oid(), new_status))
        except Exception as e:
            acm.Log('Error updating trade: %s, %s' %(trade.Oid(), e))
    acm.Log('Run completed')
