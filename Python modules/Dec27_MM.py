import ael, acm, time

def change_cf(temp, type, obj, olddate, newdate, *rest):

    new_c = obj.clone()
    if type == 'CashFlow':
        if obj.pay_day == olddate:
            new_c.pay_day = newdate
        
    try:
        new_c.commit()
        return 'Success'
    except:
        return 'could not commit'
            
    







    
# ### main ### #
olddate = ael.date_from_string('2011-12-27') 
newdate = olddate.add_days(1)
prevdate = olddate.add_days(4)
print olddate, newdate, prevdate
#corporate
exclude_list = [17697037, 17742730, 17720285, 17789326, 18130940, 18308021, 18198679, 17489080, 15501740, 18000814, 18282601, 16975203]



# ########################################################################### #


# cashflow & underlying cashflow
trd_cf_list = [4541312,
4541322,
4541325,
4541471,
4541475,
8469797,
8470631,
8470660,
8470675,
8470677,
8470687,
9813019,
10248739,
10248739,
10248752,
10248928,
10248928,
10249636,
10249655,
10249659,
10249664,
10249685,
13239803,
13239803,
13268580,
13268580,
13878533,
13878533,
14359859,
14371727,
14372008,
14527959,
14527959,
15052388,
15052388,
15436959,
15456131,
15502335,
15675003,
16228789,
16228789,
16894134,
16894134,
17033169,
17035544,
17083216,
17086817,
17549001,
17728752,
17728752,
18311744,
18381673]

for trd in trd_cf_list:
    if trd not in exclude_list:
        trd_cfs = ael.Trade[trd].insaddr.cash_flows()
        #cf = ael.CashFlow[1963407]
        for c in trd_cfs:
            print 'Trade ', trd, 'cashflow ', c.cfwnbr, change_cf(1, 'CashFlow', c, olddate, newdate)





# cashflow & underlying cashflow
trd_cf_list = [890062,
890062,
893799,
893799,
903118,
903118,
905243,
905243,
911158,
911158,
918509,
918509,
931083,
931083,
939316,
939316,
949506,
949506,
959023,
959023,
971444,
971444,
975725,
975725,
983616,
983616,
1025160,
1025160,
1044858,
1044858,
1325309,
1370119,
1370119,
1400437,
1518253,
1518253,
1654360,
1654360,
1848195,
1848195,
1849582,
1849582,
1917994,
1951621,
1993511,
1993511,
2177500,
2177500,
2646481,
3026159,
3026159,
3101250,
3821754,
3821754,
3868184,
3868184,
3980760,
3980760,
4126584,
4126584,
4180839,
4180839,
4293227,
4293227,
4307507,
4307507,
4428362,
4428362,
4986739,
4986739,
5036584,
5036584,
5036633,
5036633,
5106894,
5106894,
5213742,
5213742,
5538251,
5634757,
5634757,
5820372,
5820372,
5924100,
5924100,
6238781,
6238781,
6343468,
6343468,
6450198,
6450198,
7303368,
7426295,
7426295,
7447410,
7447410,
7522668,
7522668,
9266076,
9266076,
9848369,
9848369,
10182530,
10182530,
11551867,
11551867,
12034407,
12034407,
12100739,
12100739,
12102030,
12102030,
12146792,
12146792,
12228367,
12228367,
12767139,
12767139,
12791837,
12791837,
12808000,
12808000,
12937837,
12937837,
13003513,
13003513,
13003664,
13003664,
13005170,
13005170,
13014584,
13014584,
13014818,
13014818,
13025705,
13025705,
13032619,
13032619,
13598202,
13598202,
13599394,
13599394,
13600355,
13600355,
13601331,
13601331,
13601470,
13601470,
13601553,
13601553,
13615346,
13615346,
13617266,
13617266,
13652922,
13652922,
13653209,
13653209,
13653540,
13653540,
13678965,
13678965,
13688552,
13688552,
13688586,
13688586,
13688644,
13688644,
13689226,
13689226,
13691249,
13691249,
13691275,
13691275,
13691291,
13691291,
13691647,
13691647,
13691786,
13691786,
13691805,
13691805,
13691875,
13691875,
13692663,
13692663,
13693040,
13693040,
13693080,
13693080,
13693224,
13693224,
13693459,
13693459,
13693706,
13693706,
13693764,
13693764,
13755478,
13755478,
13757266,
13757266,
13757410,
13757410,
13757539,
13757539,
13757937,
13757937,
13769262,
13769262,
13769791,
13769791,
13844977,
13844977,
13846526,
13846526,
13847953,
13847953,
13848333,
13848333,
13848382,
13848382,
13848505,
13848505,
13849519,
13849519,
13849868,
13849868,
14132288,
14132288,
14137343,
14137343,
14137345,
14137345,
14538906,
14538906,
14539660,
14539660,
14540531,
14540531,
14540755,
14540755,
14541002,
14541002,
14549956,
14549956,
14553491,
14553491,
14553885,
14553885,
14554193,
14554193,
14554450,
14554450,
14554699,
14554699,
14687470,
14687470,
14751403,
14751403,
14806019,
14806019,
14911377,
14911377,
14915851,
14915851,
14916133,
14916133,
14916366,
14916366,
14916578,
14916578,
15093109,
15093109,
15093640,
15093640,
15439509,
15439509,
15439965,
15439965,
15440344,
15440344,
15442963,
15442963,
15443229,
15443229,
15443304,
15443304,
15443426,
15443426,
15443501,
15443501,
15621352,
15621352,
15857986,
15857986,
15858213,
15858213,
15858320,
15858320,
15858427,
15858427,
15858551,
15858551,
15858622,
15858622,
15859188,
15859188,
15859547,
15859547,
15860514,
15860514,
15860613,
15860613,
15864651,
15864651,
15864750,
15864750,
15866885,
15866885,
15867247,
15867247,
15929554,
15929554,
16509366,
16509366,
16509748,
16509748,
16509897,
16509897,
16510349,
16510349,
16510460,
16510460,
16512639,
16512639,
16512710,
16512710,
16512817,
16512817,
16513034,
16513034,
17080381,
17080381,
17080386,
17080386,
17081046,
17081046,
17081360,
17081360,
17081389,
17081389,
17081404,
17081404,
17081418,
17081418,
17081422,
17081422,
17084321,
17084321,
17084433,
17084433,
17084557,
17084557,
17085212,
17085212,
17666827,
17666827,
17667163,
17667163,
17667180,
17667180,
17667197,
17667197,
17667205,
17667205,
17667250,
17667250,
17667928,
17667928,
17668230,
17668230,
17925929,
17925929,
18072886,
18072886,
18072890,
18072890,
18072895,
18072895,
18072896,
18072896,
18072906,
18072906,
18072907,
18072907,
18073706,
18073706,
18074523,
18074523,
18074559,
18074559,
18074577,
18074577,
18074616,
18074616,
18074630,
18074630,
18074697,
18074697,
18074714,
18074714,
18074808,
18074808,
18074949,
18074949,
18075511,
18075511,
18075548,
18075548,
18077110,
18077110,
18077205,
18077205,
18077315,
18077315,
18077451,
18077451,
18077726,
18077726,
18077785,
18077785,
18078410,
18078410,
18078424,
18078424,
18078470,
18078470,
18078479,
18078479,
18078518,
18078518,
18079502,
18079502,
18079598,
18079598,
18079614,
18079614,
18079650,
18079650,
18081736,
18081736,
18081862,
18081862,
18081903,
18081903,
18081964,
18081964,
18082022,
18082022,
18082072,
18082072,
18082090,
18082090,
18170619,
18170619]

for trd in trd_cf_list:
    if trd not in exclude_list:
        trd_cfs = ael.Trade[trd].insaddr.cash_flows()
        #cf = ael.CashFlow[1963407]
        for c in trd_cfs:
            print 'Trade ', trd, 'cashflow ', c.cfwnbr, change_cf(1, 'CashFlow', c, olddate, prevdate)



# ########################################################################### #




