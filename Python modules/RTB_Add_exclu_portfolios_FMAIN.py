import acm

listOfQueryFolders = ['AGG_BSB_CORP_CASH_POSTING',
'AGG_BSB_CORP_EXP',
'AGG_BSB_CORP_INTERN_EXP',
'AGG_BSB_CORP_INTERN_TERM',
'AGG_BSB_CORP_SIM',
'AGG_BSB_CORP_TERM',
'AGG_BSB_CORP_VOID',
'AGG_BSB_GOVI_CASH_POSTING',
'AGG_BSB_GOVI_EXP',
'AGG_BSB_GOVI_INTERN_EXP',
'AGG_BSB_GOVI_INTERN_TERM',
'AGG_BSB_GOVI_SIM',
'AGG_BSB_GOVI_TERM',
'AGG_BSB_GOVI_VOID',
'AGG_CURRSWAP_CASH_POSTING',
'AGG_CURRSWAP_EXP',
'AGG_CURRSWAP_INTERN_EXP',
'AGG_CURRSWAP_INTERN_TERM',
'AGG_CURRSWAP_SIM',
'AGG_CURRSWAP_TERM',
'AGG_CURRSWAP_VOID',
'AGG_FF_BOND_OTCF_CASH_POSTING',
'AGG_FF_BOND_OTCF_EXP',
'AGG_FF_BOND_OTCF_INT_EXP',
'AGG_FF_BOND_OTCF_INT_TERM',
'AGG_FF_BOND_OTCF_SIM',
'AGG_FF_BOND_OTCF_TERM',
'AGG_FF_BOND_OTCF_VOID',
'AGG_FF_BOND_OTCT_CASH_POSTING',
'AGG_FF_BOND_OTCT_EXP',
'AGG_FF_BOND_OTCT_INT_EXP',
'AGG_FF_BOND_OTCT_INT_TERM',
'AGG_FF_BOND_OTCT_SIM',
'AGG_FF_BOND_OTCT_TERM',
'AGG_FF_BOND_OTCT_VOID',
'AGG_FF_CMDTY_INDX_OTCF_CASH_POSTING',
'AGG_FF_CMDTY_INDX_OTCF_EXP',
'AGG_FF_CMDTY_INDX_OTCF_INT_EXP',
'AGG_FF_CMDTY_INDX_OTCF_INT_TERM',
'AGG_FF_CMDTY_INDX_OTCF_SIM',
'AGG_FF_CMDTY_INDX_OTCF_TERM',
'AGG_FF_CMDTY_INDX_OTCF_VOID',
'AGG_FF_CMDTY_INDX_OTCT_CASH_POSTING',
'AGG_FF_CMDTY_INDX_OTCT_EXP',
'AGG_FF_CMDTY_INDX_OTCT_INT_EXP',
'AGG_FF_CMDTY_INDX_OTCT_INT_TERM',
'AGG_FF_CMDTY_INDX_OTCT_SIM',
'AGG_FF_CMDTY_INDX_OTCT_TERM',
'AGG_FF_CMDTY_INDX_OTCT_VOID',
'AGG_FF_COMMODITY_OTCF_CASH_POSTING',
'AGG_FF_COMMODITY_OTCF_EXP',
'AGG_FF_COMMODITY_OTCF_INT_EXP',
'AGG_FF_COMMODITY_OTCF_INT_TERM',
'AGG_FF_COMMODITY_OTCF_SIM',
'AGG_FF_COMMODITY_OTCF_TERM',
'AGG_FF_COMMODITY_OTCF_VOID',
'AGG_FF_COMMODITY_OTCT_CASH_POSTING',
'AGG_FF_COMMODITY_OTCT_EXP',
'AGG_FF_COMMODITY_OTCT_INT_EXP',
'AGG_FF_COMMODITY_OTCT_INT_TERM',
'AGG_FF_COMMODITY_OTCT_SIM',
'AGG_FF_COMMODITY_OTCT_TERM',
'AGG_FF_COMMODITY_OTCT_VOID',
'AGG_FF_CURR_OTCF_CASH_POSTING',
'AGG_FF_CURR_OTCF_EXP',
'AGG_FF_CURR_OTCF_INT_EXP',
'AGG_FF_CURR_OTCF_INT_TERM',
'AGG_FF_CURR_OTCF_SIM',
'AGG_FF_CURR_OTCF_TERM',
'AGG_FF_CURR_OTCF_VOID',
'AGG_FF_CURR_OTCT_CASH_POSTING',
'AGG_FF_CURR_OTCT_EXP',
'AGG_FF_CURR_OTCT_INT_EXP',
'AGG_FF_CURR_OTCT_INT_TERM',
'AGG_FF_CURR_OTCT_SIM',
'AGG_FF_CURR_OTCT_TERM',
'AGG_FF_CURR_OTCT_VOID',
'AGG_FF_EQUITY_INDX_OTCF_CASH_POSTING',
'AGG_FF_EQUITY_INDX_OTCF_EXP',
'AGG_FF_EQUITY_INDX_OTCF_INT_EXP',
'AGG_FF_EQUITY_INDX_OTCF_INT_TER',
'AGG_FF_EQUITY_INDX_OTCF_SIM',
'AGG_FF_EQUITY_INDX_OTCF_TERM',
'AGG_FF_EQUITY_INDX_OTCF_VOID',
'AGG_FF_EQUITY_INDX_OTCT_CASH_POSTING',
'AGG_FF_EQUITY_INDX_OTCT_EXP',
'AGG_FF_EQUITY_INDX_OTCT_INT_EXP',
'AGG_FF_EQUITY_INDX_OTCT_INT_TER',
'AGG_FF_EQUITY_INDX_OTCT_SIM',
'AGG_FF_EQUITY_INDX_OTCT_TERM',
'AGG_FF_EQUITY_INDX_OTCT_VOID',
'AGG_FF_ETF_OTCF_CASH_POSTING',
'AGG_FF_ETF_OTCF_EXP',
'AGG_FF_ETF_OTCF_INT_EXP',
'AGG_FF_ETF_OTCF_INT_TERM',
'AGG_FF_ETF_OTCF_SIM',
'AGG_FF_ETF_OTCF_TERM',
'AGG_FF_ETF_OTCF_VOID',
'AGG_FF_ETF_OTCT_CASH_POSTING',
'AGG_FF_ETF_OTCT_EXP',
'AGG_FF_ETF_OTCT_INT_EXP',
'AGG_FF_ETF_OTCT_INT_TERM',
'AGG_FF_ETF_OTCT_SIM',
'AGG_FF_ETF_OTCT_TERM',
'AGG_FF_ETF_OTCT_VOID',
'AGG_FF_ILB_OTCF_CASH_POSTING',
'AGG_FF_ILB_OTCF_EXP',
'AGG_FF_ILB_OTCF_INT_EXP',
'AGG_FF_ILB_OTCF_INT_TERM',
'AGG_FF_ILB_OTCF_SIM',
'AGG_FF_ILB_OTCF_TERM',
'AGG_FF_ILB_OTCF_VOID',
'AGG_FF_ILB_OTCT_CASH_POSTING',
'AGG_FF_ILB_OTCT_EXP',
'AGG_FF_ILB_OTCT_INT_EXP',
'AGG_FF_ILB_OTCT_INT_TERM',
'AGG_FF_ILB_OTCT_SIM',
'AGG_FF_ILB_OTCT_TERM',
'AGG_FF_ILB_OTCT_VOID',
'AGG_FF_RATE_INDX_OTCF_CASH_POSTING',
'AGG_FF_RATE_INDX_OTCF_EXP',
'AGG_FF_RATE_INDX_OTCF_INT_EXP',
'AGG_FF_RATE_INDX_OTCF_INT_TERM',
'AGG_FF_RATE_INDX_OTCF_SIM',
'AGG_FF_RATE_INDX_OTCF_TERM',
'AGG_FF_RATE_INDX_OTCF_VOID',
'AGG_FF_RATE_INDX_OTCT_CASH_POSTING',
'AGG_FF_RATE_INDX_OTCT_EXP',
'AGG_FF_RATE_INDX_OTCT_INT_EXP',
'AGG_FF_RATE_INDX_OTCT_INT_TERM',
'AGG_FF_RATE_INDX_OTCT_SIM',
'AGG_FF_RATE_INDX_OTCT_TERM',
'AGG_FF_RATE_INDX_OTCT_VOID',
'AGG_FF_STOCK_OTCF_CASH_POSTING',
'AGG_FF_STOCK_OTCF_EXP',
'AGG_FF_STOCK_OTCF_INT_EXP',
'AGG_FF_STOCK_OTCF_INT_TERM',
'AGG_FF_STOCK_OTCF_SIM',
'AGG_FF_STOCK_OTCF_TERM',
'AGG_FF_STOCK_OTCF_VOID',
'AGG_FF_STOCK_OTCT_CASH_POSTING',
'AGG_FF_STOCK_OTCT_EXP',
'AGG_FF_STOCK_OTCT_INT_EXP',
'AGG_FF_STOCK_OTCT_INT_TERM',
'AGG_FF_STOCK_OTCT_SIM',
'AGG_FF_STOCK_OTCT_TERM',
'AGG_FF_STOCK_OTCT_VOID',
'AGG_FRA_CASH_POSTING',
'AGG_FRA_EXP',
'AGG_FRA_INTERN_EXP',
'AGG_FRA_INTERN_TERM',
'AGG_FRA_SIM',
'AGG_FRA_TERM',
'AGG_FRA_VOID',
'AGG_NDF_OTCF_CASH_POSTING',
'AGG_NDF_OTCF_EXP',
'AGG_NDF_OTCF_INT_EXP',
'AGG_NDF_OTCF_INT_TERM',
'AGG_NDF_OTCF_SIM',
'AGG_NDF_OTCF_TERM',
'AGG_NDF_OTCF_VOID',
'AGG_NDF_OTCT_CASH_POSTING',
'AGG_NDF_OTCT_EXP',
'AGG_NDF_OTCT_INT_EXP',
'AGG_NDF_OTCT_INT_TERM',
'AGG_NDF_OTCT_SIM',
'AGG_NDF_OTCT_TERM',
'AGG_NDF_OTCT_VOID',
'AGG_OPT_BOND_OTCF_CASH_POSTING',
'AGG_OPT_BOND_OTCF_EXP',
'AGG_OPT_BOND_OTCF_INT_EXP',
'AGG_OPT_BOND_OTCF_INT_TERM',
'AGG_OPT_BOND_OTCF_SIM',
'AGG_OPT_BOND_OTCF_TERM',
'AGG_OPT_BOND_OTCF_VOID',
'AGG_OPT_BOND_OTCT_CASH_POSTING',
'AGG_OPT_BOND_OTCT_EXP',
'AGG_OPT_BOND_OTCT_INT_EXP',
'AGG_OPT_BOND_OTCT_INT_TERM',
'AGG_OPT_BOND_OTCT_SIM',
'AGG_OPT_BOND_OTCT_TERM',
'AGG_OPT_BOND_OTCT_VOID',
'AGG_OPT_COMMODITY_OTCF_CASH_POSTING',
'AGG_OPT_COMMODITY_OTCF_EXP',
'AGG_OPT_COMMODITY_OTCF_INT_EXP',
'AGG_OPT_COMMODITY_OTCF_INT_TERM',
'AGG_OPT_COMMODITY_OTCF_SIM',
'AGG_OPT_COMMODITY_OTCF_TERM',
'AGG_OPT_COMMODITY_OTCF_VOID',
'AGG_OPT_COMMODITY_OTCT_CASH_POSTING',
'AGG_OPT_COMMODITY_OTCT_EXP',
'AGG_OPT_COMMODITY_OTCT_INT_EXP',
'AGG_OPT_COMMODITY_OTCT_INT_TERM',
'AGG_OPT_COMMODITY_OTCT_SIM',
'AGG_OPT_COMMODITY_OTCT_TERM',
'AGG_OPT_COMMODITY_OTCT_VOID',
'AGG_OPT_CURR_OTCF_CASH_POSTING',
'AGG_OPT_CURR_OTCF_EXP',
'AGG_OPT_CURR_OTCF_INT_EXP',
'AGG_OPT_CURR_OTCF_INT_TERM',
'AGG_OPT_CURR_OTCF_SIM',
'AGG_OPT_CURR_OTCF_TERM',
'AGG_OPT_CURR_OTCF_VOID',
'AGG_OPT_CURR_OTCT_CASH_POSTING',
'AGG_OPT_CURR_OTCT_EXP',
'AGG_OPT_CURR_OTCT_INT_EXP',
'AGG_OPT_CURR_OTCT_INT_TERM',
'AGG_OPT_CURR_OTCT_SIM',
'AGG_OPT_CURR_OTCT_TERM',
'AGG_OPT_CURR_OTCT_VOID',
'AGG_OPT_EQUITY_INDX_OTCF_CASH_POSTING',
'AGG_OPT_EQUITY_INDX_OTCF_EXP',
'AGG_OPT_EQUITY_INDX_OTCF_INT_EXP',
'AGG_OPT_EQUITY_INDX_OTCF_INT_TER',
'AGG_OPT_EQUITY_INDX_OTCF_SIM',
'AGG_OPT_EQUITY_INDX_OTCF_TERM',
'AGG_OPT_EQUITY_INDX_OTCF_VOID',
'AGG_OPT_EQUITY_INDX_OTCT_CASH_POSTING',
'AGG_OPT_EQUITY_INDX_OTCT_EXP',
'AGG_OPT_EQUITY_INDX_OTCT_INT_EXP',
'AGG_OPT_EQUITY_INDX_OTCT_INT_TER',
'AGG_OPT_EQUITY_INDX_OTCT_SIM',
'AGG_OPT_EQUITY_INDX_OTCT_TERM',
'AGG_OPT_EQUITY_INDX_OTCT_VOID',
'AGG_OPT_FF_OTCF_CASH_POSTING',
'AGG_OPT_FF_OTCF_EXP',
'AGG_OPT_FF_OTCF_INT_EXP',
'AGG_OPT_FF_OTCF_INT_TERM',
'AGG_OPT_FF_OTCF_SIM',
'AGG_OPT_FF_OTCF_TERM',
'AGG_OPT_FF_OTCF_VOID',
'AGG_OPT_FF_OTCT_CASH_POSTING',
'AGG_OPT_FF_OTCT_EXP',
'AGG_OPT_FF_OTCT_INT_EXP',
'AGG_OPT_FF_OTCT_INT_TERM',
'AGG_OPT_FF_OTCT_SIM',
'AGG_OPT_FF_OTCT_TERM',
'AGG_OPT_FF_OTCT_VOID',
'AGG_OPT_FRA_OTCF_CASH_POSTING',
'AGG_OPT_FRA_OTCF_EXP',
'AGG_OPT_FRA_OTCF_INT_EXP',
'AGG_OPT_FRA_OTCF_INT_TERM',
'AGG_OPT_FRA_OTCF_SIM',
'AGG_OPT_FRA_OTCF_TERM',
'AGG_OPT_FRA_OTCF_VOID',
'AGG_OPT_FRA_OTCT_CASH_POSTING',
'AGG_OPT_FRA_OTCT_EXP',
'AGG_OPT_FRA_OTCT_INT_EXP',
'AGG_OPT_FRA_OTCT_INT_TERM',
'AGG_OPT_FRA_OTCT_SIM',
'AGG_OPT_FRA_OTCT_TERM',
'AGG_OPT_FRA_OTCT_VOID',
'AGG_OPT_STOCK_OTCF_CASH_POSTING',
'AGG_OPT_STOCK_OTCF_EXP',
'AGG_OPT_STOCK_OTCF_INT_EXP',
'AGG_OPT_STOCK_OTCF_INT_TERM',
'AGG_OPT_STOCK_OTCF_SIM',
'AGG_OPT_STOCK_OTCF_TERM',
'AGG_OPT_STOCK_OTCF_VOID',
'AGG_OPT_STOCK_OTCT_CASH_POSTING',
'AGG_OPT_STOCK_OTCT_EXP',
'AGG_OPT_STOCK_OTCT_INT_EXP',
'AGG_OPT_STOCK_OTCT_INT_TERM',
'AGG_OPT_STOCK_OTCT_SIM',
'AGG_OPT_STOCK_OTCT_TERM',
'AGG_OPT_STOCK_OTCT_VOID',
'AGG_OPT_SWAP_OTCF_CASH_POSTING',
'AGG_OPT_SWAP_OTCF_EXP',
'AGG_OPT_SWAP_OTCF_INT_EXP',
'AGG_OPT_SWAP_OTCF_INT_TERM',
'AGG_OPT_SWAP_OTCF_SIM',
'AGG_OPT_SWAP_OTCF_TERM',
'AGG_OPT_SWAP_OTCF_VOID',
'AGG_OPT_SWAP_OTCT_CASH_POSTING',
'AGG_OPT_SWAP_OTCT_EXP',
'AGG_OPT_SWAP_OTCT_INT_EXP',
'AGG_OPT_SWAP_OTCT_INT_TERM',
'AGG_OPT_SWAP_OTCT_SIM',
'AGG_OPT_SWAP_OTCT_TERM',
'AGG_OPT_SWAP_OTCT_VOID']

listOfPortfoliosToAdd = ['42721 ACS_Flow 2', '40741 ACS_FLOW', '40725 ACS EQ_Cash_Facilitation', '40709 Cash Equity Misdeals']

print('processing a list of %i query folders' %len(listOfQueryFolders))
count = 0
for queryFolderName in listOfQueryFolders:
    count = count + 1
    print('%i or %i : %s' %(count, len(listOfQueryFolders), queryFolderName))
    queryFolder = acm.FStoredASQLQuery[queryFolderName]
    originalPortfolioNode = []
    query = queryFolder.Query().Clone()
    for node in query.AsqlNodes():
        if node.IsKindOf(acm.FASQLOpNode):
            try:
                if node.AsqlNodes()[0].AsqlAttribute().AttributeString().Text() == 'Portfolio.Name':
                    originalPortfolioNode = node

                    for newPortfolio in listOfPortfoliosToAdd:
                        fAsqlAttributeNodeClone = originalPortfolioNode.AsqlNodes()[0].Clone()
                        fAsqlAttributeNodeClone.AsqlValue(newPortfolio)
                        originalPortfolioNode.AsqlNodes().Add(fAsqlAttributeNodeClone)
            except Exception, e:
                print('%s has no portfolio attribute.' %queryFolderName)
                
    queryFolder.Query(query)
    try:
        queryFolder.Commit()
    except Exception, e:
        print('ERROR: Cannot process Query Folder : %s : %s' %(queryFolderName, str(e)))
