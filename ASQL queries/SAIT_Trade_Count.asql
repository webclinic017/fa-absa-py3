/* Usage code for this ASQL */
select
ael_i(p,'ASQL_log','SAIT_Trade_Count') 'Name'
into  ASQL_LOG_TEMP
from TextObject p where 
p.name = 'SAIT_Trade_Count' and p.type = 'SQL Query' 

select 
    count(t.trdnbr),
    i.insid
from
    trade t,
    instrument i,
    portfolio p
where
    t.insaddr = i.insaddr
    and p.prfnbr = t.prfnbr
    and p.prfid in ('MIDAS_AGG')
group by 2
order by 1